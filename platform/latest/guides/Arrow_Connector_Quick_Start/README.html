<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Arrow Connector Quick Start</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta content="Scroll EclipseHelp Exporter" name="generator"/>

    <link type="text/css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet" media="print"/>
</head>
<body>
    <div class="container">
        <div class="header"/>

        <div id="43317631" class="content">
            <h1>Arrow Connector Quick Start</h1>
    <p>
    </p>
<ul class="toc-indentation "><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-Introduction">Introduction</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-CreateaConnector">Create a Connector</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-AddDependencies">Add Dependencies</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-ConfigurationFile">Configuration File</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-InitializerFile">Initializer File</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-DeveloptheConnector">Develop the Connector</a>    </p>
<ul class="toc-indentation "><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-AddConnectLogic">Add Connect Logic</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-AddRetrieveLogic">Add Retrieve Logic</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-AddCreateLogic">Add Create Logic</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-AddDeleteLogic">Add Delete Logic</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-SetupaModel">Setup a Model</a>    </p>
</li></ul></li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-PublishtheConnector">Publish the Connector</a>    </p>
</li><li class=" ">    <p>
<a class="document-link " href="#!/guide/Arrow_Connector_Quick_Start-section-43317631_ArrowConnectorQuickStart-NextSteps">Next Steps</a>    </p>
</li></ul>    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-Introduction">
        <h2 class="heading "><span>Introduction</span></h2>
    <p>
This guides covers the basic to create and build an Arrow Connector.  An Arrow Connector is a component of an Arrow project that allows you to access data from an external source.  An Arrow Connector is setup the same as an Arrow Builder project except you have logic for your connector in the <tt class=" ">lib</tt> folder, and do not have Arrow API, Block or Web components.    </p>
    <p>
For this example, the connector will integrate with the Twitter REST API.  You will need to create a new Twitter app and generate the OAuth access tokens.  To create a new Twitter app, go to <a class="external-link external-link" href="https://apps.twitter.com/" target="_blank">https://apps.twitter.com/</a>, then generate the access token from the app's <strong class=" ">Keys and Access Tokens</strong> tab.    </p>
    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-CreateaConnector">
        <h2 class="heading "><span>Create a Connector</span></h2>
    <p>
To create a new connector, from your workspace directory, execute the <tt class=" ">appc generate</tt> command.  When prompted, select <strong class=" ">Arrow Component</strong> for the type of component, <strong class=" ">Arrow Connector</strong> for the Arrow component to generate and <strong class=" ">Empty Connector Project</strong> for the connector to generate.  Enter <tt class=" ">com.connector.twitter</tt> as the name and directory name for your project.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">$ appc generate</code></div>
<div class="line"><code class="plain">Appcelerator Command-Line Interface, version </code><code class="value">0.2</code><code class="plain">.</code><code class="value">230</code></div>
<div class="line"><code class="plain">Copyright (c) </code><code class="value">2014</code><code class="plain">-</code><code class="value">2015</code><code class="plain">, Appcelerator, Inc.  All Rights Reserved.</code></div>
<div class="line"><code class="plain">? What type of component would you like to generate? Arrow Component</code></div>
<div class="line"><code class="plain">? What Arrow component would you like to generate? Arrow Connector</code></div>
<div class="line"><code class="plain">? Which Connector would you like to generate? Empty Connector Project</code></div>
<div class="line"><code class="plain">? What is the connector name? com.connector.twitter</code></div>
<div class="line"><code class="plain">? Which directory to generate into? com.connector.twitter</code></div>
</div>
</div>    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-AddDependencies">
        <h2 class="heading "><span>Add Dependencies</span></h2>
    <p>
As with all NPM modules, add your dependencies to the <tt class=" ">dependencies</tt> object in the <tt class=" ">package.json</tt> file.  This example connector will be utilizing the twitter NPM module to make calls to Twitter.  Add the <tt class=" ">twitter</tt> key with a <tt class=" ">~1.2.5</tt> value to the <tt class=" ">dependencies</tt> object.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">package.json</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">{ ...</code></div>
<div class="line"><code class="plain">    </code><code class="string">"dependencies"</code><code class="plain"> : {</code></div>
<div class="line"><code class="plain">        ...</code></div>
<div class="line"><code class="plain">        </code><code class="string">"twitter"</code><code class="plain">: </code><code class="string">"~1.2.5"</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">  ... </code></div>
<div class="line"><code class="plain">}</code></div>
</div>
</div>    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-ConfigurationFile">
        <h2 class="heading "><span>Configuration File</span></h2>
    <p>
The boiler plate sample contains the <tt class=" ">conf/default.js</tt> configuration file.  This file is used for testing the connector.  You will also need to create a configuration file called <tt class=" ">example.config.js</tt>.  When you install the connector, this file is copied the the Arrow project's <tt class=" ">conf</tt> directory.  You need to add settings to configure your connector in these files, specifically add the settings to the <tt class=" ">connectors</tt> object.  For the Twitter connector, it will need the app keys, OAuth tokens and an account name of the Twitter feed to access.  Create the <tt class=" ">conf/example.config.js</tt> file, then add the content below to it.  You will also need to add the following keys to the connectors object in the <tt class=" ">conf/default.js</tt> file and add your Twitter app information to it for testing purposes.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./conf/example.config.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">module.exports = {</code></div>
<div class="line"><code class="plain">    connectors: {</code></div>
<div class="line"><code class="plain">        </code><code class="string">'com.connector.twitter'</code><code class="plain">: {</code></div>
<div class="line"><code class="plain">            account: </code><code class="string">'TWITTER_ACCOUNT'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            consumer_key: </code><code class="string">'TWITTER_API_KEY'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            consumer_secret: </code><code class="string">'TWITTER_API_SECRET'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            access_token_key: </code><code class="string">'TWITTER_ACCESS_TOKEN'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            access_token_secret: </code><code class="string">'TWITTER_ACCESS_TOKEN_SECRET'</code><code class="plain">       </code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
</div>    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-InitializerFile">
        <h2 class="heading "><span>Initializer File</span></h2>
    <p>
The <tt class=" ">app.js</tt> file contains code that initializes the connector when it is used as a server for testing.  You can hook into the lifecycle events of the server.  The boiler plate file contains logic that is used to create a model.  Update the code to let the application create a connector and access the tweet's text response parameter as the <tt class=" ">status</tt> parameter. Later on, you will add logic to automatically create a model when a connector is installed to an Arrow application.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">app.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">        server = </code><code class="keyword">new</code><code class="plain"> Arrow();</code></div>
<div class="line"><code class="plain">server.addModel(Arrow.Model.extend(</code><code class="string">'tweet'</code><code class="plain">, {</code></div>
<div class="line"><code class="plain">    fields: {</code></div>
<div class="line"><code class="plain">        status: { type: String, name: </code><code class="string">'text'</code><code class="plain"> }</code></div>
<div class="line"><code class="plain">    },</code></div>
<div class="line"><code class="plain">    connector: </code><code class="string">'com.connector.twitter'</code></div>
<div class="line"><code class="plain">}));</code></div>
<div class="line"><code class="plain">server.start();</code></div>
</div>
</div>    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-DeveloptheConnector">
        <h2 class="heading "><span>Develop the Connector</span></h2>
    <p>
Arrow will guide you through the rest of the process.  To start developing your connector, run the project in one console window, then edit the files with the connector logic in another console or editor.  As you save your files, Arrow will automatically update your connector and restart the server instance, allowing you to work on and test the connector incrementally.    </p>
    <p>
Let's get started. First, run the project and look at the log output:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">appc run</code></div>
<div class="line"><code class="plain">...</code></div>
<div class="line"><code class="plain">This connector does not </code><code class="keyword">do</code><code class="plain"> much of anything at the moment.</code></div>
<div class="line"><code class="plain">Why don't you take a look at the </code><code class="string">"capabilities"</code><code class="plain"> array in:</code></div>
<div class="line"><code class="plain">/Users/jdoe/workspace/com.connector.twitternew/lib/index.js</code></div>
</div>
</div>    <p>
Follow the log instructions and open the <tt class=" ">./lib/index.js</tt> file.  You will see an exposed create function that uses the <tt class=" ">Connector.extend()</tt> method to create a new connector.  In the object passed to the <tt class=" ">extend()</tt> method, you will see a capabilities field with an array of <tt class=" ">Capability</tt> constants.  The constants are used to indicate to Arrow, which operations the connector can perform.  We will add capabilities incrementally.    </p>
    <p>
Let's start with connecting to a datasource.    </p>
<ol class=" "><li class=" ">    <p>
Add the <tt class=" ">defaultConfig</tt> field to the parameter object passed to the <tt class=" ">extend()</tt> method.  The <tt class=" ">defaultConfig</tt> field tells Arrow to copy the example configuration file to the Arrow project's <tt class=" ">conf</tt> directory when the user add the connector to the Arrow project.    </p>
</li><li class=" ">    <p>
Uncomment the line containing <tt class=" ">Capabilities.ConnectsToADataSource.</tt>    </p>
</li><li class=" ">    <p>
Add the<tt class=" "> postCreate()</tt> function to attach a helper function to the connector instance that can be used by other connector methods.    </p>
</li></ol><div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/index.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">...</code></div>
<div class="line"><code class="plain">exports.create = function (Arrow) {</code></div>
<div class="line"><code class="plain">    ...</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> Connector.extend({</code></div>
<div class="line"><code class="plain">        defaultConfig: require(</code><code class="string">'fs'</code><code class="plain">).readFileSync(__dirname + </code><code class="string">'/../conf/example.config.js'</code><code class="plain">, </code><code class="string">'utf8'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">        ...</code></div>
<div class="line"><code class="plain">        capabilities: [</code></div>
<div class="line"><code class="plain">            Capabilities.ConnectsToADataSource,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// TODO: Each of these capabilities is optional; add the ones you want, and delete the rest.</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// (Hint: I've found it to be easiest to add these one at a time, running `appc run` for guidance.)</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.ValidatesConfiguration,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.ContainsModels,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.GeneratesModels,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.CanCreate,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.CanRetrieve,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.CanUpdate,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.CanDelete,</code></div>
<div class="line"><code class="plain">            </code><code class="comments">//Capabilities.AuthenticatesThroughConnector</code></div>
<div class="line"><code class="plain">        ],</code></div>
<div class="line"><code class="plain">        postCreate: function() {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">this</code><code class="plain">.createInstance = function (Model, data) {</code></div>
<div class="line"><code class="plain">                var model = Model.instance(data, </code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                model.setPrimaryKey(data.id_str);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">return</code><code class="plain"> model;</code></div>
<div class="line"><code class="plain">            };</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div>    <p>
Save the file.  You will see the following log output:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">The </code><code class="string">"ConnectsToADataSource"</code><code class="plain"> capability has been enabled, so we need to make a couple of changes:</code></div>
<div class="line"><code class="plain"> - Created `lib/lifecycle/connect.js` (contains </code><code class="value">2</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain"> - Created `lib/lifecycle/disconnect.js` (contains </code><code class="value">2</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain">Please go take a look at the TODOs in these </code><code class="keyword">new</code><code class="plain"> files, then </code><code class="keyword">do</code><code class="plain"> an `appc run` or `npm test` to </code><code class="keyword">try</code><code class="plain"> out the </code><code class="keyword">new</code><code class="plain"> capabilities.</code></div>
</div>
</div>    <p>
Arrow generates some new files in the <tt class=" ">lib</tt> folder.  You will need to implement some logic to connect to and disconnect from the datasource.    </p>
    <div class="section section-3 " id="43317631_ArrowConnectorQuickStart-AddConnectLogic">
        <h3 class="heading "><span>Add Connect Logic</span></h3>
    <p>
Open <tt class=" ">./lib/lifecycle/connect.js</tt> and replace the contents of the file with the following.  The <tt class=" ">connect.js</tt> file contains logic to implement the connector's <a class="external-link external-link" href="#!/api/Arrow.Connector-method-connect"><tt class=" ">connect()</tt> method</a>, which authorizes the connector to talk to the Twitter APIs.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/lifecycle/connect.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Twitter = require(</code><code class="string">'twitter'</code><code class="plain">);</code></div>
<div class="line"><code class="plain">exports.connect = function (next) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Initialize the client</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Use this.config to get values from the configuration file</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.client = </code><code class="keyword">new</code><code class="plain"> Twitter({</code></div>
<div class="line"><code class="plain">        consumer_key: </code><code class="keyword">this</code><code class="plain">.config.consumer_key,</code></div>
<div class="line"><code class="plain">        consumer_secret: </code><code class="keyword">this</code><code class="plain">.config.consumer_secret,</code></div>
<div class="line"><code class="plain">        access_token_key: </code><code class="keyword">this</code><code class="plain">.config.access_token_key,</code></div>
<div class="line"><code class="plain">        access_token_secret: </code><code class="keyword">this</code><code class="plain">.config.access_token_secret</code></div>
<div class="line"><code class="plain">    });        </code></div>
<div class="line"><code class="plain">    next();</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div>    <p>
Next, let's implement some logic to retrieve the tweets.    </p>
    </div>
    <div class="section section-3 " id="43317631_ArrowConnectorQuickStart-AddRetrieveLogic">
        <h3 class="heading "><span>Add Retrieve Logic</span></h3>
    <p>
To allow the connector to retrieve model data, implement the <tt class=" ">CanRetrieve</tt> capability.    </p>
<ol class=" "><li class=" ">    <p>
Open the <tt class=" ">./lib/index.js</tt> file, uncomment the line containing <tt class=" ">Capabilities.CanRetrieve</tt> and save the file.  The Arrow log output tells us to update four new files that Arrow just generated.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">The </code><code class="string">"CanRetrieve"</code><code class="plain"> capability has been enabled, so we need to make a couple of changes:</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/distinct.js` (contains </code><code class="value">3</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/findAll.js` (contains </code><code class="value">3</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/findOne.js` (contains </code><code class="value">4</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/query.js` (contains </code><code class="value">5</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain">(Hint: If you only want to support some of these methods, feel free to delete the others.)</code></div>
<div class="line"><code class="plain">Please go take a look at the TODOs in these </code><code class="keyword">new</code><code class="plain"> files, then </code><code class="keyword">do</code><code class="plain"> an `appc run` or `npm test` to </code><code class="keyword">try</code><code class="plain"> out the </code><code class="keyword">new</code><code class="plain"> capabilities.</code></div>
</div>
</div></li><li class=" ">    <p>
Remove the <tt class=" ">distinct.js</tt> and <tt class=" ">query.js</tt> files.  We will not be implementing these for the example.    </p>
</li><li class=" ">    <p>
Open <tt class=" ">./lib/methods/findAll.js</tt> and replace the contents of the file with the following.  The <tt class=" ">findAll.js</tt> file implements the connector's <tt class=" ">findAll()</tt> method, which retrieves all tweets from the user's Twitter account, or at least, as many tweets as Twitter will allow us to fetch.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/methods/findAll.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">    Collection = Arrow.Collection,</code></div>
<div class="line"><code class="plain">    ORMError = Arrow.ORMError;</code></div>
<div class="line"><code class="plain">exports.findAll = function findAll(Model, callback) {</code></div>
<div class="line"><code class="plain">        var params = {screen_name: </code><code class="keyword">this</code><code class="plain">.config.account};</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// this Twitter API only returns the last twenty tweets</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.client.get(</code><code class="string">'statuses/user_timeline'</code><code class="plain">, params, function(error, tweets, response) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (!error) {</code></div>
<div class="line"><code class="plain">            var results = [];</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">for</code><code class="plain"> (var i = </code><code class="value">0</code><code class="plain">; i &lt; tweets.length; i++) {</code></div>
<div class="line"><code class="plain">                results.push(Model.connector.createInstance(Model, tweets[i]));</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">null</code><code class="plain">, </code><code class="keyword">new</code><code class="plain"> Collection(Model, results));</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">this</code><code class="plain">.logger.error(error);</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">new</code><code class="plain"> ORMError(</code><code class="string">'ERROR: Could not fetch tweets!'</code><code class="plain">));</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div></li><li class=" ">    <p>
Open <tt class=" ">./lib/methods/findOne.js</tt> and replace the contents of the file with the following. The <tt class=" ">findOne.js</tt> file implements the connector's <tt class=" ">findOne()</tt> method, which retrieves one specific tweet, identified by its ID, from the datasource.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/methods/findOne.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">    ORMError = Arrow.ORMError;</code></div>
<div class="line"><code class="plain">exports.findOne = function (Model, id, callback) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.client.get(</code><code class="string">'statuses/show/'</code><code class="plain"> + id, {}, function(error, tweet, response) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (!error) {</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">null</code><code class="plain">, Model.connector.createInstance(Model, tweet));</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">this</code><code class="plain">.logger.error(error);</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">new</code><code class="plain"> ORMError(</code><code class="string">'ERROR: Could not fetch tweet!'</code><code class="plain">));</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div></li></ol>    <p>
Let's see if the connector's retrieve logic works.    </p>
    <p>
In a web browser:    </p>
<ol class=" "><li class=" ">    <p>
Navigate to the Arrow Admin console.  You can access it using the following URL: <tt class=" ">http://localhost:8080/arrow</tt>.    </p>
</li><li class=" ">    <p>
In the top navigation bar, click the <strong class=" ">Data</strong> tab.    </p>
</li><li class=" ">    <p>
In the left navigation bar, click <strong class=" ">tweet</strong>.    </p>
</li></ol>    <p>
The Admin console will retrieve and display the user's tweets.    </p>
    <p>
Next, let's add some logic to create a tweet.    </p>
    </div>
    <div class="section section-3 " id="43317631_ArrowConnectorQuickStart-AddCreateLogic">
        <h3 class="heading "><span>Add Create Logic</span></h3>
    <p>
To allow the connector to create data, implement the <tt class=" ">CanCreate</tt> capability.    </p>
<ol class=" "><li class=" ">    <p>
Open the <tt class=" ">./lib/index.js</tt> file, uncomment the line containing <tt class=" ">Capabilities.CanCreate</tt> and save the file. You will see the following console output:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">The </code><code class="string">"CanCreate"</code><code class="plain"> capability has been enabled, so we need to make a couple of changes:</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/create.js` (contains </code><code class="value">3</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain">Please go take a look at the TODOs in these </code><code class="keyword">new</code><code class="plain"> files, then </code><code class="keyword">do</code><code class="plain"> an `appc run` or `npm test` to </code><code class="keyword">try</code><code class="plain"> out the </code><code class="keyword">new</code><code class="plain"> capabilities.</code></div>
</div>
</div></li><li class=" ">    <p>
Open <tt class=" ">./lib/methods/create.js</tt> and replace the contents of the file with the following. The <tt class=" ">create.js</tt> file implements the connector's <tt class=" ">create()</tt> method, which allows the connector to post a tweet in the user's Twitter feed.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/methods/create.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">    ORMError = Arrow.ORMError;</code></div>
<div class="line"><code class="plain">exports.create = function (Model, values, callback) {</code></div>
<div class="line"><code class="plain">    var params = {</code><code class="string">'status'</code><code class="plain">: values.text};</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.client.post(</code><code class="string">'statuses/update'</code><code class="plain">, params, function(error, tweet, response) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (!error) {</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">null</code><code class="plain">, Model.connector.createInstance(Model, tweet));</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">new</code><code class="plain"> ORMError(</code><code class="string">'ERROR: Unable to create tweet!'</code><code class="plain">));</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div></li></ol>    <p>
Let's test the create logic.    </p>
    <p>
In the Admin console, you should still see the list of tweets.  If not, click <strong class=" ">Data</strong> in the top navigation bar, then click <strong class=" ">tweet</strong> in the left navigation bar.    </p>
<ol class=" "><li class=" ">    <p>
Click the <strong class=" ">Add (+)</strong> button in the top-right corner of the console. A dialog will appear.    </p>
</li><li class=" ">    <p>
Enter a status message, then click <strong class=" ">OK</strong>.    </p>
</li></ol>    <p>
The new status message will be displayed in the list of tweets.    </p>
    <p>
Next, let's add some logic to remove the tweets.    </p>
    </div>
    <div class="section section-3 " id="43317631_ArrowConnectorQuickStart-AddDeleteLogic">
        <h3 class="heading "><span>Add Delete Logic</span></h3>
    <p>
To allow the connector to remove data, implement the <tt class=" ">CanDelete</tt> capability.    </p>
<ol class=" "><li class=" ">    <p>
Open the <tt class=" ">./lib/index.js</tt> file, uncomment the line containing <tt class=" ">Capabilities.CanDelete</tt> and save the file. You will see the following console output:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">The </code><code class="string">"CanDelete"</code><code class="plain"> capability has been enabled, so we need to make a couple of changes:</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/delete.js` (contains </code><code class="value">4</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain"> - Created `lib/methods/deleteAll.js` (contains </code><code class="value">3</code><code class="plain"> TODOs)</code></div>
<div class="line"><code class="plain">(Hint: If you only want to support some of these methods, feel free to delete the others.)</code></div>
<div class="line"><code class="plain">Please go take a look at the TODOs in these </code><code class="keyword">new</code><code class="plain"> files, then </code><code class="keyword">do</code><code class="plain"> an `appc run` or `npm test` to </code><code class="keyword">try</code><code class="plain"> out the </code><code class="keyword">new</code><code class="plain"> capabilities.</code></div>
</div>
</div></li><li class=" ">    <p>
Remove the <tt class=" ">lib/methods/deleteAll.js</tt>.    </p>
</li><li class=" ">    <p>
Open <tt class=" ">./lib/methods/delete.js</tt> and replace the contents of the file with the following. The <tt class=" ">delete.js</tt> file implements the connector's <tt class=" ">delete()</tt> method, which allows the connector to delete a specific tweet, specified by its ID, from the user's Twitter feed.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./lib/methods/delete.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">),</code></div>
<div class="line"><code class="plain">    ORMError = Arrow.ORMError;</code></div>
<div class="line"><code class="plain">exports[</code><code class="string">'delete'</code><code class="plain">] = function (Model, instance, callback) {</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.client.post(</code><code class="string">'statuses/destroy/'</code><code class="plain"> + instance.id + </code><code class="string">'.json'</code><code class="plain">, {}, function(error, tweet, response) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (!error) {</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">null</code><code class="plain">, Model.connector.createInstance(Model, tweet));</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            callback(</code><code class="keyword">new</code><code class="plain"> ORMError(</code><code class="string">'ERROR: Could not delete tweet!'</code><code class="plain">));</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">};</code></div>
</div>
</div></li></ol>    <p>
Let's test the delete logic.    </p>
    <p>
In the Admin console, you should still see the list of tweets.  If not, click <strong class=" ">Data</strong> in the top navigation bar, then click <strong class=" ">tweet</strong> in the left navigation bar.    </p>
<ol class=" "><li class=" ">    <p>
Click the tweet you previously added in the list.  A dialog appears.    </p>
</li><li class=" ">    <p>
Click <strong class=" ">Delete</strong>.    </p>
</li></ol>    <p>
The new status message will be removed from the list of tweets.    </p>
    </div>
    <div class="section section-3 " id="43317631_ArrowConnectorQuickStart-SetupaModel">
        <h3 class="heading "><span>Setup a Model</span></h3>
    <p>
To have a model included with your connector, implement the <tt class=" ">ContainModel</tt> capability.    </p>
<ol class=" "><li class=" ">    <p>
Remove the <tt class=" ">server.addModel</tt> method from the <tt class=" ">app.js</tt> file.    </p>
</li><li class=" ">    <p>
Open the <tt class=" ">./lib/index.js</tt> file, uncomment the line containing <tt class=" ">Capabilities.ContainModel</tt> and save the file. You will see the following console output:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">The </code><code class="string">"ContainsModels"</code><code class="plain"> capability has been enabled, so we need to make a couple of changes:</code></div>
<div class="line"><code class="plain"> - Created `models/yourModel.js` (contains </code><code class="value">2</code><code class="plain"> TODOs)</code></div>
</div>
</div></li><li class=" ">    <p>
Rename the <tt class=" ">yourModel.js</tt> file to <tt class=" ">tweet.js</tt>.    </p>
</li><li class=" ">    <p>
Open <tt class=" ">./models/tweet.js</tt> and replace the contents of the file with the following:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="title">./models/tweet.js</div>
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Arrow = require(</code><code class="string">'arrow'</code><code class="plain">);</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">var Tweet = Arrow.Model.extend(</code><code class="string">'tweet'</code><code class="plain">, {</code></div>
<div class="line"><code class="plain">    fields: {</code></div>
<div class="line"><code class="plain">        status: { type: String, name: </code><code class="string">'text'</code><code class="plain"> }</code></div>
<div class="line"><code class="plain">    },</code></div>
<div class="line"><code class="plain">    connector: </code><code class="string">'com.connector.twitter'</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">module.exports = Tweet;</code></div>
</div>
</div></li></ol>    <p>
Reload the Admin console and retest adding and removing a model.    </p>
    </div>
    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-PublishtheConnector">
        <h2 class="heading "><span>Publish the Connector</span></h2>
    <p>
To publish the connector, execute the following command from the project directory:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">appc publish</code></div>
</div>
</div>    <p>
By default, the access level for the connector is set to private, so only the creator can access the connector.  To share the connector with other people or publicly, specify a different access level with the <tt class=" ">appc access</tt> command and add people or orgs to your component using the <tt class=" ">appc user</tt> and <tt class=" ">appc org</tt> commands.    </p>
    </div>
    <div class="section section-2 " id="43317631_ArrowConnectorQuickStart-NextSteps">
        <h2 class="heading "><span>Next Steps</span></h2>
    <p>
For information about installing your connector, see <a class="document-link " href="#!/guide/Add_a_Connector">Add a Connector</a>.    </p>
    <p>
For information about creating a connector, see <a class="document-link " href="#!/guide/Arrow_Connector_Project">Arrow Connector Project</a>.    </p>
    <p>
    </p>
    </div>
        </div><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=43317631"><span>Edit</span></a>
    
        <div class="footer">
            Created with <a href="http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence" target="_blank">Scroll EclipseHelp Exporter for Confluence</a>.
        </div>
    </div>
</body>
</html>
