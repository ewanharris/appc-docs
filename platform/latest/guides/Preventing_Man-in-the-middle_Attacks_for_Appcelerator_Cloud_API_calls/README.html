<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Preventing Man-in-the-middle Attacks for Appcelerator Cloud API calls</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta content="Scroll EclipseHelp Exporter" name="generator"/>

    <link type="text/css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet" media="print"/>
</head>
<body>
    <div class="container">
        <div class="header"/>

        <div id="46256121" class="content">
            <h1>Preventing Man-in-the-middle Attacks for Appcelerator Cloud API calls</h1>
    <div class="section section-2 " id="46256121_PreventingMan-in-the-middleAttacksforAppceleratorCloudAPIcalls-PreventingMan-in-the-middleAttacksforCloudAPIcalls">
        <h2 class="heading "><span>Preventing Man-in-the-middle Attacks for Cloud API calls</span></h2>
    <p>
This info only applies to users who intend to do API calls to Appcelerator Cloud while using the https module.    </p>
    <p>
You only need to generate your own certificate if you are using the https module and NOT the ti.cloud modules.    </p>
    <p>
Note: you will need https module and ti.cloud module to test this sample app:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var Cloud = require(</code><code class="string">'ti.cloud'</code><code class="plain">);</code></div>
<div class="line"><code class="plain">var win = Ti.UI.createWindow({</code></div>
<div class="line"><code class="plain">	backgroundColor: </code><code class="string">'white'</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="plain">Cloud.createX509CertificatePinningSecurityManager([</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        url: </code><code class="string">"https://api.cloud.appcelerator.com"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        serverCertificate: </code><code class="string">"api.cloud.appcelerator.com.der"</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">]);</code></div>
<div class="line"><code class="plain">var btn = Ti.UI.createButton({</code></div>
<div class="line"><code class="plain">	title: </code><code class="string">'Login User in Ti.Cloud'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">	top: </code><code class="string">'50%'</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="plain">btn.addEventListener(</code><code class="string">'click'</code><code class="plain">, function(e) {</code></div>
<div class="line"><code class="comments">//any Cloud calls here will do</code></div>
<div class="line"><code class="plain">	Cloud.Users.login({</code></div>
<div class="line"><code class="plain">	    login: </code><code class="string">'test@mycompany.com'</code><code class="plain">,</code></div>
<div class="line"><code class="plain">	    password: </code><code class="string">'test_password'</code></div>
<div class="line"><code class="plain">	}, function (e) {</code></div>
<div class="line"><code class="plain">	    </code><code class="keyword">if</code><code class="plain"> (e.success) {</code></div>
<div class="line"><code class="plain">	        var user = e.users[</code><code class="value">0</code><code class="plain">];</code></div>
<div class="line"><code class="plain">	        alert(</code><code class="string">'Success:\n'</code><code class="plain"> +</code></div>
<div class="line"><code class="plain">	            </code><code class="string">'id: '</code><code class="plain"> + user.id + </code><code class="string">'\n'</code><code class="plain"> +</code></div>
<div class="line"><code class="plain">	            </code><code class="string">'sessionId: '</code><code class="plain"> + Cloud.sessionId + </code><code class="string">'\n'</code><code class="plain"> +</code></div>
<div class="line"><code class="plain">	            </code><code class="string">'first name: '</code><code class="plain"> + user.first_name + </code><code class="string">'\n'</code><code class="plain"> +</code></div>
<div class="line"><code class="plain">	            </code><code class="string">'last name: '</code><code class="plain"> + user.last_name);</code></div>
<div class="line"><code class="plain">	    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">	        alert(</code><code class="string">'Error:\n'</code><code class="plain"> +</code></div>
<div class="line"><code class="plain">	            ((e.error &amp;&amp; e.message) || JSON.stringify(e)));</code></div>
<div class="line"><code class="plain">	    }</code></div>
<div class="line"><code class="plain">	});</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="plain">win.add(btn);</code></div>
<div class="line"><code class="plain">win.open();</code></div>
</div>
</div>    <div class="section section-3 " id="46256121_PreventingMan-in-the-middleAttacksforAppceleratorCloudAPIcalls-Stepstotest">
        <h3 class="heading "><span>Steps to test</span></h3>
<ol class=" "><li class=" ">    <p>
Create a <strong class=" ">new Classic app</strong>.    </p>
</li><li class=" ">    <p>
<strong class=" ">Enable cloud services</strong> and include both <strong class=" ">ti.cloud</strong> and <strong class=" ">https modules</strong>.    </p>
</li><li class=" ">    <p>
Include attached <a class="attachment-link " href="./attachments_46728449_1_api.cloud.appcelerator.com.der">.der certificate</a> in the <strong class=" ">Resources</strong> directory.    </p>
</li><li class=" ">    <p>
Build and run.    </p>
</li><li class=" ">    <p>
Click <strong class=" ">btn</strong>.    </p>
</li></ol>    <p>
When testing the http client connecting to the https site at this point, you should get an error message saying that no user or password was found which is what is expected to report if everything was set up properly.    </p>
    </div>
    </div>
        </div><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=46256121"><span>Edit</span></a>
    
        <div class="footer">
            Created with <a href="http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence" target="_blank">Scroll EclipseHelp Exporter for Confluence</a>.
        </div>
    </div>
</body>
</html>
